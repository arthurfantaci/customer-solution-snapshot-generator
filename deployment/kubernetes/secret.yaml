apiVersion: v1
kind: Secret
metadata:
  name: customer-snapshot-secrets
  namespace: customer-snapshot-generator
  labels:
    app: customer-snapshot-generator
    component: secrets
type: Opaque
data:
  # API Keys - Base64 encoded placeholders
  # Replace these with actual base64-encoded values
  anthropic-api-key: eW91cl9hbnRocm9waWNfYXBpX2tleV9oZXJl # your_anthropic_api_key_here
  voyageai-api-key: eW91cl92b3lhZ2VhaV9hcGlfa2V5X2hlcmU= # your_voyageai_api_key_here
  tavily-api-key: eW91cl90YXZpbHlfYXBpX2tleV9oZXJl # your_tavily_api_key_here

  # Database credentials (if using external database)
  database-url: cG9zdGdyZXNxbDovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvZGI= # postgresql://user:password@localhost:5432/db

  # Redis credentials (if using external Redis)
  redis-url: cmVkaXM6Ly9sb2NhbGhvc3Q6NjM3OS8w # redis://localhost:6379/0

  # SSL/TLS certificates (if needed)
  tls-cert: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0t # -----BEGIN CERTIFICATE-----
  tls-key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0t # -----BEGIN PRIVATE KEY-----

---
# External secrets operator configuration (optional)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-secret-store
  namespace: customer-snapshot-generator
spec:
  provider:
    vault:
      server: "https://vault.example.com"
      path: "secret"
      version: "v2"
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "customer-snapshot-generator"
          serviceAccountRef:
            name: "customer-snapshot-sa"

---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: customer-snapshot-external-secrets
  namespace: customer-snapshot-generator
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-secret-store
    kind: SecretStore
  target:
    name: customer-snapshot-secrets
    creationPolicy: Owner
  data:
    - secretKey: anthropic-api-key
      remoteRef:
        key: customer-snapshot/production
        property: anthropic_api_key
    - secretKey: voyageai-api-key
      remoteRef:
        key: customer-snapshot/production
        property: voyageai_api_key
    - secretKey: tavily-api-key
      remoteRef:
        key: customer-snapshot/production
        property: tavily_api_key
